{"version":3,"file":"index.es.js","sources":["../src/utils.js","../node_modules/style-inject/dist/style-inject.es.js","../src/PinchZoom/component.js"],"sourcesContent":["// @flow\nimport type { UpdateAction } from \"./PinchZoom/types.js\";\nimport type { Point, Interaction } from \"./types\";\n\nexport const { abs, max, min, sqrt } = Math;\n\nconst isMac = /(Mac)/i.test(navigator.platform);\n\nexport const isDragInteraction = (i: ?Interaction): boolean => i === \"drag\";\n\nexport const isZoomInteraction = (i: ?Interaction): boolean => i === \"zoom\";\n\nexport const isZoomGesture = (wheelEvent: WheelEvent) =>\n  isMac && wheelEvent.ctrlKey;\n\nexport const cancelEvent = (event: any): void => {\n  // event.stopPropagation();\n  // event.preventDefault();\n};\n\nconst getDistance = (a: Point, b: Point): number => {\n  const x = a.x - b.x;\n  const y = a.y - b.y;\n\n  return sqrt(x * x + y * y);\n};\n\nexport const calculateScale = (\n  startTouches: Array<Point>,\n  endTouches: Array<Point>\n): number => {\n  const startDistance = getDistance(startTouches[0], startTouches[1]);\n  const endDistance = getDistance(endTouches[0], endTouches[1]);\n\n  return endDistance / startDistance;\n};\n\nexport const isCloseTo = (value: number, expected: number) =>\n  value > expected - 0.01 && value < expected + 0.01;\n\nexport const swing = (p: number): number => -Math.cos(p * Math.PI) / 2 + 0.5;\n\nexport const getPointByPageCoordinates = (touch: Touch): Point => ({\n  x: touch.pageX,\n  y: touch.pageY\n});\n\nexport const getPageCoordinatesByTouches = (touches: TouchList): Array<Point> =>\n  [...touches].map(getPointByPageCoordinates);\n\nconst sum = (a: number, b: number): number => a + b;\n\nexport const getVectorAvg = (vectors: Array<Point>): Point => ({\n  x: vectors.map(({ x }) => x).reduce(sum, 0) / vectors.length,\n  y: vectors.map(({ y }) => y).reduce(sum, 0) / vectors.length\n});\n\nexport const clamp = (min: number, max: number, value: number): number =>\n  value < min ? min : value > max ? max : value;\n\nexport const isTouch = () =>\n  \"ontouchstart\" in window || navigator.maxTouchPoints > 0;\n\nexport const shouldInterceptWheel = (event: WheelEvent): boolean =>\n  !(event.ctrlKey || event.metaKey);\n\nexport const hasTranslate3DSupport = () => {\n  const css = window.CSS;\n\n  return css && css.supports && css.supports(\"transform\", \"translate3d(0,0,0)\");\n};\n\nexport const getElementSize = (\n  element: any\n): {| width: number, height: number |} => {\n  if (element) {\n    const { offsetWidth, offsetHeight } = element;\n\n    // Any DOMElement\n    if (offsetWidth && offsetHeight) {\n      return { width: offsetWidth, height: offsetHeight };\n    }\n\n    // Svg support\n    const style = getComputedStyle(element);\n    const width = parseFloat(style.width);\n    const height = parseFloat(style.height);\n\n    if (height && width) {\n      return { width, height };\n    }\n  }\n\n  return { width: 0, height: 0 };\n};\n\nexport const make2dTransformValue = ({ x, y, scale }: UpdateAction) =>\n  `scale(${scale}) translate(${x}px, ${y}px)`;\n\nexport const make3dTransformValue = ({ x, y, scale }: UpdateAction) =>\n  `scale3d(${scale},${scale}, 1) translate3d(${x}px, ${y}px, 0)`;\n\nexport const calculateVelocity = (\n  startPoint: Point,\n  endPoint: Point\n): Point => ({\n  x: endPoint.x - startPoint.x,\n  y: endPoint.y - startPoint.y\n});\n\nexport const comparePoints = (p1: Point, p2: Point) =>\n  p1.x === p2.x && p1.y === p2.y;\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","// @flow\nimport React, { Children, cloneElement, Component, createRef } from \"react\";\nimport cn from \"classnames\";\n\nimport {\n  abs,\n  calculateScale,\n  cancelEvent,\n  clamp,\n  getElementSize,\n  getPageCoordinatesByTouches,\n  getVectorAvg,\n  isCloseTo,\n  isDragInteraction,\n  isTouch,\n  isZoomGesture,\n  isZoomInteraction,\n  max,\n  min,\n  shouldInterceptWheel,\n  swing,\n  calculateVelocity,\n  comparePoints\n} from \"../utils\";\nimport styles from \"./styles.css\";\n\nimport type { Interaction, Point } from \"../types\";\nimport type { Props, AnimateOptions, ScaleToOptions } from \"./types\";\n\nexport const noup = () => {};\nconst zeroPoint = { x: 0, y: 0 };\nconst document = window.document;\nconst { documentElement: _html, body: _body } = document;\n\nclass PinchZoom extends Component<Props> {\n  static defaultProps = {\n    animationDuration: 250,\n    draggableUnZoomed: true,\n    enabled: true,\n    inertia: true,\n    inertiaFriction: 0.96,\n    horizontalPadding: 0,\n    isTouch,\n    lockDragAxis: false,\n    maxZoom: 5,\n    minZoom: 0.5,\n    onDoubleTap: noup,\n    onDragEnd: noup,\n    onDragStart: noup,\n    onDragUpdate: noup,\n    onZoomEnd: noup,\n    onZoomStart: noup,\n    onZoomUpdate: noup,\n    setOffsetsOnce: false,\n    shouldInterceptWheel,\n    tapZoomFactor: 1,\n    verticalPadding: 0,\n    wheelScaleFactor: 1500,\n    zoomOutFactor: 1.3,\n\n    _html,\n    _body\n  };\n\n  _velocity: ?null;\n  _prevDragMovePoint: ?Point = null;\n  _containerObserver: ?ResizeObserver = null;\n  _fingers: number = 0;\n  _firstMove: boolean = true;\n  _hasInteraction: boolean;\n  _inAnimation: boolean;\n  _initialOffset: Point = { ...zeroPoint };\n  _interaction: ?Interaction = null;\n  _isDoubleTap: boolean = false;\n  _isOffsetsSet: boolean = false;\n  _lastDragPosition: ?Point = null;\n  _lastScale: number = 1;\n  _lastTouchStart: number = 0;\n  _lastZoomCenter: ?Point = null;\n  _listenMouseMove: boolean = false;\n  _nthZoom: number = 0;\n  _offset: Point = { ...zeroPoint };\n  _startTouches = null;\n  _updatePlaned: boolean = false;\n  _wheelTimeOut: ?TimeoutID = null;\n  _zoomFactor: number = 1;\n  _initialZoomFactor: number = 1;\n  // It help reduce behavior difference between touch and mouse events\n  _ignoreNextClick: boolean = false;\n\n  _containerRef = createRef<HTMLDivElement>();\n\n  _handleClick = (clickEvent: Event) => {\n    if (this._ignoreNextClick) {\n      this._ignoreNextClick = false;\n\n      clickEvent.stopPropagation();\n    }\n  };\n\n  _handleDragStart(event: TouchEvent) {\n    this._ignoreNextClick = true;\n\n    this.props.onDragStart();\n\n    this._stopAnimation();\n    this._resetInertia();\n    this._lastDragPosition = null;\n    this._hasInteraction = true;\n    this._handleDrag(event);\n  }\n\n  _handleDrag(event: TouchEvent) {\n    const touch: Point = this._getOffsetByFirstTouch(event);\n    this._drag(touch, this._lastDragPosition);\n    this._offset = this._sanitizeOffset(this._offset);\n    this._lastDragPosition = touch;\n  }\n\n  _resetInertia() {\n    this._velocity = null;\n    this._prevDragMovePoint = null;\n  }\n\n  _realizeInertia() {\n    const { inertiaFriction, inertia } = this.props;\n\n    if (!inertia || !this._velocity) {\n      return;\n    }\n\n    let { x, y } = this._velocity;\n\n    if (x || y) {\n      this._stopAnimation();\n      this._resetInertia();\n\n      const renderFrame = () => {\n        x *= inertiaFriction;\n        y *= inertiaFriction;\n\n        if (!x && !y) {\n          return this._stopAnimation();\n        }\n\n        const prevOffset = { ...this._offset };\n\n        this._addOffset({ x, y });\n        this._offset = this._sanitizeOffset(this._offset);\n\n        if (comparePoints(prevOffset, this._offset)) {\n          return this._stopAnimation();\n        }\n\n        this._update({ isAnimation: true });\n      };\n\n      this._animate(renderFrame, { duration: 9999 });\n    }\n  }\n\n  _collectInertia({ touches }: TouchEvent) {\n    if (!this.props.inertia) {\n      return;\n    }\n\n    const currentCoordinates = getPageCoordinatesByTouches(touches)[0];\n    const prevPoint = this._prevDragMovePoint;\n\n    if (prevPoint) {\n      // $FlowFixMe\n      this._velocity = calculateVelocity(currentCoordinates, prevPoint);\n    }\n\n    this._prevDragMovePoint = currentCoordinates;\n  }\n\n  _handleDragEnd() {\n    this.props.onDragEnd();\n    this._end();\n    this._realizeInertia();\n  }\n\n  _handleZoomStart() {\n    this.props.onZoomStart();\n    this._stopAnimation();\n    this._lastScale = 1;\n    this._nthZoom = 0;\n    this._lastZoomCenter = null;\n    this._hasInteraction = true;\n  }\n\n  _handleZoom(event: TouchEvent, newScale: number) {\n    const touchCenter = getVectorAvg(this._getOffsetTouches(event));\n    const scale = newScale / this._lastScale;\n\n    this._lastScale = newScale;\n\n    // The first touch events are thrown away since they are not precise\n    this._nthZoom += 1;\n\n    if (this._nthZoom > 3) {\n      this._scale(scale, touchCenter);\n      this._drag(touchCenter, this._lastZoomCenter);\n    }\n\n    this._lastZoomCenter = touchCenter;\n  }\n\n  _handleZoomEnd() {\n    this.props.onZoomEnd();\n    this._end();\n  }\n\n  _handleDoubleTap(event: TouchEvent) {\n    if (this._hasInteraction) {\n      return;\n    }\n\n    this.props.onDoubleTap();\n\n    this._ignoreNextClick = true;\n\n    const zoomFactor = this._zoomFactor + this.props.tapZoomFactor;\n    const startZoomFactor = this._zoomFactor;\n    const updateProgress = progress => {\n      this._scaleTo(\n        startZoomFactor + progress * (zoomFactor - startZoomFactor),\n        center\n      );\n    };\n    let center = this._getOffsetByFirstTouch(event);\n\n    this._isDoubleTap = true;\n\n    if (startZoomFactor > zoomFactor) {\n      center = this._getCurrentZoomCenter();\n    }\n\n    this._animate(updateProgress);\n  }\n\n  _computeInitialOffset() {\n    const rect = this._getContainerRect();\n    const { width, height } = this._getChildSize();\n    const x = -abs(width * this._getInitialZoomFactor() - rect.width) / 2;\n    const y = -abs(height * this._getInitialZoomFactor() - rect.height) / 2;\n\n    this._initialOffset = { x, y };\n  }\n\n  _resetOffset() {\n    this._offset = { ...this._initialOffset };\n  }\n\n  _setupOffsets() {\n    if (this.props.setOffsetsOnce && this._isOffsetsSet) {\n      return;\n    }\n\n    this._isOffsetsSet = true;\n\n    this._computeInitialOffset();\n    this._resetOffset();\n  }\n\n  _sanitizeOffset(offset: Point) {\n    const rect = this._getContainerRect();\n    const { width, height } = this._getChildSize();\n    const elWidth = width * this._getInitialZoomFactor() * this._zoomFactor;\n    const elHeight = height * this._getInitialZoomFactor() * this._zoomFactor;\n    const maxX = elWidth - rect.width + this.props.horizontalPadding;\n    const maxY = elHeight - rect.height + this.props.verticalPadding;\n    const maxOffsetX = max(maxX, 0);\n    const maxOffsetY = max(maxY, 0);\n    const minOffsetX = min(maxX, 0) - this.props.horizontalPadding;\n    const minOffsetY = min(maxY, 0) - this.props.verticalPadding;\n\n    return {\n      x: clamp(minOffsetX, maxOffsetX, offset.x),\n      y: clamp(minOffsetY, maxOffsetY, offset.y)\n    };\n  }\n\n  alignCenter(options: ScaleToOptions) {\n    const { x, y, scale, animated, duration } = {\n      duration: 250,\n      animated: true,\n      ...options\n    };\n\n    const startZoomFactor = this._zoomFactor;\n    const startOffset = { ...this._offset };\n    const rect = this._getContainerRect();\n    const containerCenter = { x: rect.width / 2, y: rect.height / 2 };\n\n    this._zoomFactor = 1;\n    this._offset = { x: -(containerCenter.x - x), y: -(containerCenter.y - y) };\n\n    this._scaleTo(scale, containerCenter);\n    this._stopAnimation();\n\n    if (!animated) {\n      return this._update();\n    }\n\n    const diffZoomFactor = this._zoomFactor - startZoomFactor;\n    const diffOffset = {\n      x: this._offset.x - startOffset.x,\n      y: this._offset.y - startOffset.y\n    };\n\n    this._zoomFactor = startZoomFactor;\n    this._offset = { ...startOffset };\n\n    const updateFrame = progress => {\n      const x = startOffset.x + diffOffset.x * progress;\n      const y = startOffset.y + diffOffset.y * progress;\n\n      this._zoomFactor = startZoomFactor + diffZoomFactor * progress;\n      this._offset = this._sanitizeOffset({ x, y });\n      this._update();\n    };\n\n    this._animate(updateFrame, {\n      callback: () => this._sanitize(),\n      duration\n    });\n  }\n\n  scaleTo(options: ScaleToOptions) {\n    const { x, y, scale, animated, duration } = {\n      duration: 250,\n      animated: true,\n      ...options\n    };\n\n    const startZoomFactor = this._zoomFactor;\n    const startOffset = { ...this._offset };\n\n    this._zoomFactor = 1;\n    this._offset = { x: 0, y: 0 };\n\n    this._scaleTo(scale, { x, y });\n    this._stopAnimation();\n\n    if (!animated) {\n      return this._update();\n    }\n\n    const diffZoomFactor = this._zoomFactor - startZoomFactor;\n    const diffOffset = {\n      x: this._offset.x - startOffset.x,\n      y: this._offset.y - startOffset.y\n    };\n\n    this._zoomFactor = startZoomFactor;\n    this._offset = { ...startOffset };\n\n    const updateFrame = progress => {\n      const x = startOffset.x + diffOffset.x * progress;\n      const y = startOffset.y + diffOffset.y * progress;\n\n      this._zoomFactor = startZoomFactor + diffZoomFactor * progress;\n      this._offset = { x, y };\n\n      this._update();\n    };\n\n    this._animate(updateFrame, { callback: () => this._sanitize(), duration });\n  }\n\n  _scaleTo(zoomFactor: number, center: Point) {\n    this._scale(zoomFactor / this._zoomFactor, center);\n  }\n\n  _scale(scale: number, center: Point) {\n    scale = this._scaleZoomFactor(scale);\n\n    this._addOffset({\n      x: (scale - 1) * (center.x + this._offset.x),\n      y: (scale - 1) * (center.y + this._offset.y)\n    });\n\n    this.props.onZoomUpdate();\n  }\n\n  _scaleZoomFactor(scale: number) {\n    const originalZoomFactor = this._zoomFactor;\n    this._zoomFactor *= scale;\n    this._zoomFactor = clamp(\n      this.props.minZoom,\n      this.props.maxZoom,\n      this._zoomFactor\n    );\n    return this._zoomFactor / originalZoomFactor;\n  }\n\n  _canDrag() {\n    return this.props.draggableUnZoomed || !isCloseTo(this._zoomFactor, 1);\n  }\n\n  _drag(center: Point, lastCenter: ?Point) {\n    if (lastCenter) {\n      const y = -(center.y - lastCenter.y);\n      const x = -(center.x - lastCenter.x);\n\n      if (!this.props.lockDragAxis) {\n        this._addOffset({\n          x,\n          y\n        });\n      } else {\n        // lock scroll to position that was changed the most\n        if (abs(x) > abs(y)) {\n          this._addOffset({\n            x,\n            y: 0\n          });\n        } else {\n          this._addOffset({\n            y,\n            x: 0\n          });\n        }\n      }\n\n      this.props.onDragUpdate();\n    }\n  }\n\n  _addOffset(offset: Point) {\n    const { x, y } = this._offset;\n\n    this._offset = {\n      x: x + offset.x,\n      y: y + offset.y\n    };\n  }\n\n  _sanitize() {\n    if (this._zoomFactor < this.props.zoomOutFactor) {\n      this._zoomOutAnimation();\n    } else if (this._isInsaneOffset()) {\n      this._sanitizeOffsetAnimation();\n    }\n  }\n\n  _isInsaneOffset() {\n    const offset = this._offset;\n    const sanitizedOffset = this._sanitizeOffset(offset);\n\n    return sanitizedOffset.x !== offset.x || sanitizedOffset.y !== offset.y;\n  }\n\n  _sanitizeOffsetAnimation() {\n    const targetOffset = this._sanitizeOffset(this._offset);\n    const startOffset: Point = { ...this._offset };\n    const updateProgress = progress => {\n      const x = startOffset.x + progress * (targetOffset.x - startOffset.x);\n      const y = startOffset.y + progress * (targetOffset.y - startOffset.y);\n\n      this._offset = { x, y };\n      this._update();\n    };\n\n    this._animate(updateProgress);\n  }\n\n  _zoomOutAnimation() {\n    if (this._zoomFactor === 1) {\n      return;\n    }\n\n    const startZoomFactor = this._zoomFactor;\n    const zoomFactor = 1;\n    const center = this._getCurrentZoomCenter();\n    const updateProgress = progress => {\n      const scaleFactor =\n        startZoomFactor + progress * (zoomFactor - startZoomFactor);\n\n      this._scaleTo(scaleFactor, center);\n    };\n\n    this._animate(updateProgress);\n  }\n\n  _getInitialZoomFactor() {\n    return this._initialZoomFactor;\n  }\n\n  _getCurrentZoomCenter() {\n    const { x, y } = this._offset;\n    const offsetLeft = x - this._initialOffset.x;\n    const offsetTop = y - this._initialOffset.y;\n\n    return {\n      x: -1 * x - offsetLeft / (1 / this._zoomFactor - 1),\n      y: -1 * y - offsetTop / (1 / this._zoomFactor - 1)\n    };\n  }\n\n  _getOffsetByFirstTouch(event: TouchEvent): Point {\n    return this._getOffsetTouches(event)[0];\n  }\n\n  _getOffsetTouches(event: TouchEvent): Array<Point> {\n    const { _html, _body } = this.props;\n    const { top, left } = this._getContainerRect();\n    const scrollTop = _html.scrollTop || _body ? _body.scrollTop : 0;\n    const scrollLeft = _html.scrollLeft || _body ? _body.scrollLeft : 0;\n    const posTop = top + scrollTop;\n    const posLeft = left + scrollLeft;\n\n    return getPageCoordinatesByTouches(event.touches).map(({ x, y }) => ({\n      x: x - posLeft,\n      y: y - posTop\n    }));\n  }\n\n  _animate(frameFn: number => void, options?: AnimateOptions) {\n    const startTime = new Date().getTime();\n    const { timeFn, callback, duration } = {\n      timeFn: swing,\n      callback: () => {},\n      duration: this.props.animationDuration,\n      ...options\n    };\n    const renderFrame = () => {\n      if (!this._inAnimation) {\n        return;\n      }\n\n      const frameTime = new Date().getTime() - startTime;\n      let progress = frameTime / duration;\n\n      if (frameTime >= duration) {\n        frameFn(1);\n        this._stopAnimation();\n        callback();\n        this._update();\n      } else {\n        progress = timeFn(progress);\n        frameFn(progress);\n        this._update({ isAnimation: true });\n        requestAnimationFrame(renderFrame);\n      }\n    };\n    this._inAnimation = true;\n\n    requestAnimationFrame(renderFrame);\n  }\n\n  _stopAnimation() {\n    this._inAnimation = false;\n  }\n\n  _end() {\n    this._hasInteraction = false;\n    this._sanitize();\n    this._update();\n  }\n\n  _getContainerRect(): ClientRect {\n    const { current: div } = this._containerRef;\n\n    // $FlowFixMe\n    return div.getBoundingClientRect();\n  }\n\n  _getChildSize(): {| width: number, height: number |} {\n    const { current: div } = this._containerRef;\n    const child = div && div.firstElementChild;\n\n    return getElementSize(child);\n  }\n\n  _updateInitialZoomFactor() {\n    const rect = this._getContainerRect();\n    const size = this._getChildSize();\n    const xZoomFactor = rect.width / size.width;\n    const yZoomFactor = rect.height / size.height;\n\n    this._initialZoomFactor = min(xZoomFactor, yZoomFactor);\n  }\n\n  _onResize = () => {\n    this._updateInitialZoomFactor();\n    this._setupOffsets();\n    this._update();\n  };\n\n  _bindEvents() {\n    const { current: div } = this._containerRef;\n\n    if (window.ResizeObserver) {\n      this._containerObserver = new ResizeObserver(this._onResize);\n    } else {\n      window.addEventListener(\"resize\", this._onResize);\n    }\n\n    this._handlers.forEach(([eventName, fn, target]) => {\n      // $FlowFixMe\n      (target || div).addEventListener(eventName, fn, true);\n    });\n\n    // $FlowFixMe\n    [...div.querySelectorAll(\"img\")].forEach(img =>\n      img.addEventListener(\"load\", this._onResize)\n    );\n  }\n\n  _unSubscribe() {\n    const { current: div } = this._containerRef;\n\n    if (this._containerObserver) {\n      this._containerObserver.disconnect();\n      this._containerObserver = null;\n    }\n\n    window.removeEventListener(\"resize\", this._onResize);\n\n    this._handlers.forEach(([eventName, fn, target]) => {\n      // $FlowFixMe\n      (target || div).removeEventListener(eventName, fn, true);\n    });\n  }\n\n  _update(options?: {| isAnimation: boolean |}) {\n    if (this._updatePlaned) {\n      return;\n    }\n\n    const updateFrame = () => {\n      const scale = this._getInitialZoomFactor() * this._zoomFactor;\n      const x = -this._offset.x / scale;\n      const y = -this._offset.y / scale;\n\n      this.props.onUpdate({ scale, x, y });\n    };\n\n    if (options && options.isAnimation) {\n      return updateFrame();\n    }\n\n    this._updatePlaned = true;\n\n    requestAnimationFrame(() => {\n      this._updatePlaned = false;\n\n      updateFrame();\n    });\n  }\n\n  _handlerIfEnable(fn: (...a: any) => void) {\n    return (...args: Array<any>) => {\n      if (this.props.enabled) {\n        fn(...args);\n      }\n    };\n  }\n\n  _setInteraction(newInteraction: ?Interaction, event: TouchEvent) {\n    const interaction = this._interaction;\n\n    if (interaction !== newInteraction) {\n      if (interaction && !newInteraction) {\n        if (isZoomInteraction(interaction)) {\n          this._handleZoomEnd();\n        } else if (isDragInteraction(interaction)) {\n          this._handleDragEnd();\n        }\n      }\n\n      if (isZoomInteraction(newInteraction)) {\n        this._handleZoomStart();\n      } else if (isDragInteraction(newInteraction)) {\n        this._handleDragStart(event);\n      }\n    }\n\n    this._interaction = newInteraction;\n  }\n\n  _updateInteraction(event: TouchEvent) {\n    const fingers = this._fingers;\n\n    if (fingers === 2) {\n      return this._setInteraction(\"zoom\", event);\n    }\n\n    if (fingers === 1 && this._canDrag()) {\n      return this._setInteraction(\"drag\", event);\n    }\n\n    this._setInteraction(null, event);\n  }\n\n  _detectDoubleTap(event: TouchEvent) {\n    const time = new Date().getTime();\n\n    if (this._fingers > 1) {\n      this._lastTouchStart = 0;\n    }\n\n    if (time - this._lastTouchStart < 300) {\n      cancelEvent(event);\n\n      this._handleDoubleTap(event);\n\n      if (isZoomInteraction(this._interaction)) {\n        this._handleZoomEnd();\n      } else if (isDragInteraction(this._interaction)) {\n        this._handleDragEnd();\n      }\n    } else {\n      this._isDoubleTap = false;\n    }\n\n    if (this._fingers === 1) {\n      this._lastTouchStart = time;\n    }\n  }\n\n  _handlerOnTouchEnd = this._handlerIfEnable((touchEndEvent: TouchEvent) => {\n    this._fingers = touchEndEvent.touches.length;\n    this._updateInteraction(touchEndEvent);\n  });\n\n  _handlerOnTouchStart = this._handlerIfEnable(\n    (touchStartEvent: TouchEvent) => {\n      this._firstMove = true;\n      this._fingers = touchStartEvent.touches.length;\n      this._detectDoubleTap(touchStartEvent);\n    }\n  );\n\n  _handlerOnTouchMove = this._handlerIfEnable((touchMoveEvent: TouchEvent) => {\n    if (this._isDoubleTap) {\n      return;\n    }\n\n    this._collectInertia(touchMoveEvent);\n\n    if (this._firstMove) {\n      this._updateInteraction(touchMoveEvent);\n\n      if (this._interaction) {\n        cancelEvent(touchMoveEvent);\n      }\n\n      this._startTouches = getPageCoordinatesByTouches(touchMoveEvent.touches);\n    } else {\n      if (isZoomInteraction(this._interaction)) {\n        if (\n          this._startTouches &&\n          this._startTouches.length === 2 &&\n          touchMoveEvent.touches.length === 2\n        ) {\n          this._handleZoom(\n            touchMoveEvent,\n            calculateScale(\n              this._startTouches,\n              getPageCoordinatesByTouches(touchMoveEvent.touches)\n            )\n          );\n        }\n      } else if (isDragInteraction(this._interaction)) {\n        this._handleDrag(touchMoveEvent);\n      }\n      if (this._interaction) {\n        cancelEvent(touchMoveEvent);\n        this._update();\n      }\n    }\n\n    this._firstMove = false;\n  });\n\n  simulate(fn: (e: TouchEvent) => void): MouseEvent => void {\n    return mouseEvent => {\n      const { pageX, pageY, type } = mouseEvent;\n      const isEnd = type === \"mouseup\";\n      const isStart = type === \"mousedown\";\n      if (isStart) {\n        mouseEvent.preventDefault();\n\n        this._listenMouseMove = true;\n      }\n\n      if (this._listenMouseMove) {\n        // $FlowFixMe\n        mouseEvent.touches = isEnd ? [] : [{ pageX, pageY }];\n\n        // $FlowFixMe\n        fn(mouseEvent);\n      }\n\n      if (isEnd) {\n        this._listenMouseMove = false;\n      }\n    };\n  }\n\n  _handlerWheel = (wheelEvent: WheelEvent) => {\n    if (this.props.shouldInterceptWheel(wheelEvent)) {\n      return;\n    }\n\n    cancelEvent(wheelEvent);\n\n    const { pageX, pageY, deltaY, deltaMode } = wheelEvent;\n\n    let scaleDelta = 1;\n\n    if (isZoomGesture(wheelEvent) || deltaMode === 1) {\n      scaleDelta = 15;\n    }\n\n    // $FlowFixMe\n    const likeTouchEvent: TouchEvent = { touches: [{ pageX, pageY }] };\n    const center = this._getOffsetByFirstTouch(likeTouchEvent);\n    const dScale = deltaY * scaleDelta;\n\n    this._stopAnimation();\n    this._scaleTo(\n      this._zoomFactor - dScale / this.props.wheelScaleFactor,\n      center\n    );\n    this._update();\n\n    clearTimeout(this._wheelTimeOut);\n    this._wheelTimeOut = setTimeout(() => this._sanitize(), 100);\n  };\n\n  _handlers = this.props.isTouch()\n    ? [\n        [\"touchstart\", this._handlerOnTouchStart],\n        [\"touchend\", this._handlerOnTouchEnd],\n        [\"touchmove\", this._handlerOnTouchMove]\n      ]\n    : [\n        [\"mousemove\", this.simulate(this._handlerOnTouchMove), document],\n        [\"mousedown\", this.simulate(this._handlerOnTouchStart)],\n        [\"mouseup\", this.simulate(this._handlerOnTouchEnd), document],\n        [\"click\", this._handleClick],\n        [\"wheel\", this._handlerWheel]\n      ];\n\n  componentDidMount() {\n    this._bindEvents();\n    this._update();\n  }\n\n  componentWillUnmount() {\n    this._stopAnimation();\n    this._unSubscribe();\n  }\n\n  render() {\n    const { children, containerProps } = this.props;\n    const child = Children.only(children);\n    const props = containerProps || {};\n\n    return (\n      <div\n        {...props}\n        ref={this._containerRef}\n        // $FlowFixMe\n        className={cn(styles.a, props.className)}\n      >\n        {cloneElement(child, {\n          className: cn(styles.b, child.props.className)\n        })}\n      </div>\n    );\n  }\n}\n\nif (process.env.NODE_ENV !== \"production\") {\n  const { element, object, number, any, func, bool } = require(\"prop-types\");\n\n  PinchZoom.propTypes = {\n    children: element,\n    containerProps: object,\n    wheelScaleFactor: number,\n    animationDuration: number,\n    draggableUnZoomed: bool,\n    enabled: bool,\n    horizontalPadding: number,\n    lockDragAxis: bool,\n    onUpdate: func.isRequired,\n    maxZoom: number,\n    minZoom: number,\n    onDoubleTap: func,\n    onDragEnd: func,\n    onDragStart: func,\n    onDragUpdate: func,\n    onZoomEnd: func,\n    onZoomStart: func,\n    onZoomUpdate: func,\n    setOffsetsOnce: bool,\n    tapZoomFactor: number,\n    verticalPadding: number,\n    zoomOutFactor: number,\n    isTouch: func,\n    _html: any,\n    _body: any\n  };\n}\n\nexport default PinchZoom;\n"],"names":["abs","Math","max","min","sqrt","isMac","test","navigator","platform","isDragInteraction","i","isZoomInteraction","isZoomGesture","wheelEvent","ctrlKey","getDistance","a","b","x","y","calculateScale","startTouches","endTouches","startDistance","endDistance","isCloseTo","value","expected","swing","p","cos","PI","getPointByPageCoordinates","touch","pageX","pageY","getPageCoordinatesByTouches","touches","map","sum","getVectorAvg","vectors","reduce","length","clamp","isTouch","window","maxTouchPoints","shouldInterceptWheel","event","metaKey","hasTranslate3DSupport","css","CSS","supports","getElementSize","element","offsetWidth","offsetHeight","width","height","style","getComputedStyle","parseFloat","make2dTransformValue","scale","make3dTransformValue","calculateVelocity","startPoint","endPoint","comparePoints","p1","p2","noup","zeroPoint","document","_html","documentElement","_body","body","PinchZoom","createRef","clickEvent","_ignoreNextClick","stopPropagation","_updateInitialZoomFactor","_setupOffsets","_update","_handlerIfEnable","touchEndEvent","_fingers","_updateInteraction","touchStartEvent","_firstMove","_detectDoubleTap","touchMoveEvent","_isDoubleTap","_collectInertia","_interaction","_startTouches","_handleZoom","_handleDrag","cancelEvent","props","deltaY","deltaMode","scaleDelta","likeTouchEvent","center","_getOffsetByFirstTouch","dScale","_stopAnimation","_scaleTo","_zoomFactor","wheelScaleFactor","clearTimeout","_wheelTimeOut","setTimeout","_sanitize","_handlerOnTouchStart","_handlerOnTouchEnd","_handlerOnTouchMove","simulate","_handleClick","_handlerWheel","onDragStart","_resetInertia","_lastDragPosition","_hasInteraction","_drag","_offset","_sanitizeOffset","_velocity","_prevDragMovePoint","inertiaFriction","inertia","renderFrame","prevOffset","_addOffset","isAnimation","_animate","duration","currentCoordinates","prevPoint","onDragEnd","_end","_realizeInertia","onZoomStart","_lastScale","_nthZoom","_lastZoomCenter","newScale","touchCenter","_getOffsetTouches","_scale","onZoomEnd","onDoubleTap","zoomFactor","tapZoomFactor","startZoomFactor","updateProgress","progress","_getCurrentZoomCenter","rect","_getContainerRect","_getChildSize","_getInitialZoomFactor","_initialOffset","setOffsetsOnce","_isOffsetsSet","_computeInitialOffset","_resetOffset","offset","elWidth","elHeight","maxX","horizontalPadding","maxY","verticalPadding","maxOffsetX","maxOffsetY","minOffsetX","minOffsetY","options","animated","startOffset","containerCenter","diffZoomFactor","diffOffset","updateFrame","callback","_scaleZoomFactor","onZoomUpdate","originalZoomFactor","minZoom","maxZoom","draggableUnZoomed","lastCenter","lockDragAxis","onDragUpdate","zoomOutFactor","_zoomOutAnimation","_isInsaneOffset","_sanitizeOffsetAnimation","sanitizedOffset","targetOffset","scaleFactor","_initialZoomFactor","offsetLeft","offsetTop","top","left","scrollTop","scrollLeft","posTop","posLeft","frameFn","startTime","Date","getTime","timeFn","animationDuration","_inAnimation","frameTime","requestAnimationFrame","div","_containerRef","current","getBoundingClientRect","child","firstElementChild","size","xZoomFactor","yZoomFactor","ResizeObserver","_containerObserver","_onResize","addEventListener","_handlers","forEach","eventName","fn","target","querySelectorAll","img","disconnect","removeEventListener","_updatePlaned","onUpdate","enabled","newInteraction","interaction","_handleZoomEnd","_handleDragEnd","_handleZoomStart","_handleDragStart","fingers","_setInteraction","_canDrag","time","_lastTouchStart","_handleDoubleTap","mouseEvent","type","isEnd","isStart","preventDefault","_listenMouseMove","_bindEvents","_unSubscribe","children","containerProps","Children","only","cn","styles","className","cloneElement","Component","process","env","NODE_ENV","require","object","number","any","func","bool","propTypes","isRequired"],"mappings":"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"}